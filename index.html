<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ó–æ–ª–æ—Ç–æ–µ –∫–æ–ª—å—Ü–æ –†–æ—Å—Å–∏–∏</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: var(--tg-theme-bg-color, #fff);
            color: var(--tg-theme-text-color, #000);
        }
        .header {
            text-align: center;
            padding: 15px;
            background-color: var(--tg-theme-bg-color, #fff);
            border-bottom: 1px solid var(--tg-theme-hint-color, #ccc);
        }
        .header h1 {
            margin: 0;
            font-size: 1.5em;
            color: var(--tg-theme-text-color, #000);
        }
        .cities-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 10px;
            padding: 10px;
        }
        .city-card {
            background-color: var(--tg-theme-bg-color, #fff);
            border-radius: 8px;
            padding: 15px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            cursor: pointer;
            transition: transform 0.2s;
            border: 1px solid var(--tg-theme-hint-color, #ccc);
        }
        .city-card:hover {
            transform: translateY(-2px);
        }
        .city-name {
            font-size: 1.1em;
            font-weight: bold;
            margin-bottom: 5px;
            color: var(--tg-theme-text-color, #000);
        }
        .city-description {
            color: var(--tg-theme-hint-color, #666);
            font-size: 0.8em;
        }
        .places-list {
            padding: 10px;
        }
        .place-card {
            background-color: var(--tg-theme-bg-color, #fff);
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 10px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            border: 1px solid var(--tg-theme-hint-color, #ccc);
        }
        .place-name {
            font-size: 1.1em;
            font-weight: bold;
            margin-bottom: 8px;
            color: var(--tg-theme-text-color, #000);
        }
        .place-info {
            color: var(--tg-theme-hint-color, #666);
            margin-bottom: 4px;
            font-size: 0.9em;
        }
        .rating {
            color: var(--tg-theme-link-color, #f39c12);
            font-weight: bold;
        }
        .comments {
            margin-top: 8px;
            padding-top: 8px;
            border-top: 1px solid var(--tg-theme-hint-color, #eee);
        }
        .comment {
            background-color: var(--tg-theme-secondary-bg-color, #f9f9f9);
            padding: 8px;
            margin-bottom: 4px;
            border-radius: 4px;
            font-size: 0.9em;
        }
        .add-place-form {
            padding: 15px;
            background-color: var(--tg-theme-bg-color, #fff);
        }
        .form-group {
            margin-bottom: 12px;
        }
        label {
            display: block;
            margin-bottom: 4px;
            color: var(--tg-theme-text-color, #000);
            font-size: 0.9em;
        }
        input, textarea, select {
            width: 100%;
            padding: 8px;
            border: 1px solid var(--tg-theme-hint-color, #ddd);
            border-radius: 4px;
            box-sizing: border-box;
            background-color: var(--tg-theme-bg-color, #fff);
            color: var(--tg-theme-text-color, #000);
        }
        button {
            background-color: var(--tg-theme-button-color, #4CAF50);
            color: var(--tg-theme-button-text-color, #fff);
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 1em;
            width: 100%;
        }
        button:hover {
            opacity: 0.9;
        }
        .message {
            margin-top: 15px;
            padding: 10px;
            border-radius: 4px;
            font-size: 0.9em;
        }
        .success {
            background-color: var(--tg-theme-secondary-bg-color, #dff0d8);
            color: var(--tg-theme-text-color, #3c763d);
        }
        .error {
            background-color: var(--tg-theme-secondary-bg-color, #f2dede);
            color: var(--tg-theme-text-color, #a94442);
        }
        .back-button {
            background-color: var(--tg-theme-button-color, #666);
            margin-bottom: 15px;
        }
        .rating-buttons {
            display: flex;
            gap: 5px;
            margin-top: 10px;
        }
        .rating-button {
            flex: 1;
            padding: 8px;
            font-size: 1.2em;
        }
        .comment-form {
            margin-top: 10px;
        }
        .comment-input {
            width: 100%;
            padding: 8px;
            margin-bottom: 8px;
            border: 1px solid var(--tg-theme-hint-color, #ddd);
            border-radius: 4px;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>–ó–æ–ª–æ—Ç–æ–µ –∫–æ–ª—å—Ü–æ –†–æ—Å—Å–∏–∏</h1>
    </div>

    <div id="cities-container">
        <div class="cities-grid" id="cities-grid">
            <!-- –ì–æ—Ä–æ–¥–∞ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã —á–µ—Ä–µ–∑ JavaScript -->
        </div>
    </div>

    <div id="places-container" style="display: none;">
        <button class="back-button" onclick="showCities()">‚Üê –ù–∞–∑–∞–¥ –∫ –≥–æ—Ä–æ–¥–∞–º</button>
        <h2 id="city-title"></h2>
        <p id="city-description"></p>
        <div id="places-list" class="places-list">
            <!-- –î–æ—Å—Ç–æ–ø—Ä–∏–º–µ—á–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã —á–µ—Ä–µ–∑ JavaScript -->
        </div>
    </div>

    <div class="add-place-form">
        <h2>–î–æ–±–∞–≤–∏—Ç—å –¥–æ—Å—Ç–æ–ø—Ä–∏–º–µ—á–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å</h2>
        <form id="placeForm">
            <div class="form-group">
                <label for="city">–ì–æ—Ä–æ–¥:</label>
                <select id="city" name="city" required>
                    <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –≥–æ—Ä–æ–¥</option>
                </select>
            </div>

            <div class="form-group">
                <label for="name">–ù–∞–∑–≤–∞–Ω–∏–µ:</label>
                <input type="text" id="name" name="name" required>
            </div>

            <div class="form-group">
                <label for="description">–û–ø–∏—Å–∞–Ω–∏–µ:</label>
                <textarea id="description" name="description" rows="3" required></textarea>
            </div>

            <div class="form-group">
                <label for="address">–ê–¥—Ä–µ—Å:</label>
                <input type="text" id="address" name="address" required>
            </div>

            <div class="form-group">
                <label for="category">–ö–∞—Ç–µ–≥–æ—Ä–∏—è:</label>
                <select id="category" name="category" required>
                    <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é</option>
                    <option value="–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞">–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞</option>
                    <option value="–ú—É–∑–µ–∏">–ú—É–∑–µ–∏</option>
                    <option value="–ò—Å—Ç–æ—Ä–∏—è">–ò—Å—Ç–æ—Ä–∏—è</option>
                    <option value="–ü—Ä–∏—Ä–æ–¥–∞">–ü—Ä–∏—Ä–æ–¥–∞</option>
                    <option value="–†–∞–∑–≤–ª–µ—á–µ–Ω–∏—è">–†–∞–∑–≤–ª–µ—á–µ–Ω–∏—è</option>
                    <option value="–†–µ–ª–∏–≥–∏—è">–†–µ–ª–∏–≥–∏—è</option>
                    <option value="–î—Ä—É–≥–æ–µ">–î—Ä—É–≥–æ–µ</option>
                </select>
            </div>

            <div class="form-group">
                <label for="image">–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ:</label>
                <input type="file" id="image" name="image" accept="image/*">
            </div>

            <button type="submit">–î–æ–±–∞–≤–∏—Ç—å</button>
        </form>
        <div id="message"></div>
    </div>

    <script>
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram WebApp
        const tg = window.Telegram.WebApp;
        tg.expand();
        tg.enableClosingConfirmation();

        // –î–∞–Ω–Ω—ã–µ –æ –≥–æ—Ä–æ–¥–∞—Ö
        const cities = {
            "–ú–æ—Å–∫–≤–∞": "–°—Ç–æ–ª–∏—Ü–∞ –†–æ—Å—Å–∏–∏, –≥–æ—Ä–æ–¥ —Ñ–µ–¥–µ—Ä–∞–ª—å–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è",
            "–Ø—Ä–æ—Å–ª–∞–≤–ª—å": "–ì–æ—Ä–æ–¥ –≤ –†–æ—Å—Å–∏–∏",
            "–ò–≤–∞–Ω–æ–≤–æ": "–ì–æ—Ä–æ–¥ –≤ –†–æ—Å—Å–∏–∏ –Ω–∞ –±–µ—Ä–µ–≥–∞—Ö —Ä–µ–∫–∏ –£–≤–æ–¥–∏",
            "–í–ª–∞–¥–∏–º–∏—Ä": "–ì–æ—Ä–æ–¥ –≤ –†–æ—Å—Å–∏–∏",
            "–ö–∞–ª—É–≥–∞": "–ì–æ—Ä–æ–¥ –≤ –µ–≤—Ä–æ–ø–µ–π—Å–∫–æ–π —á–∞—Å—Ç–∏ –†–æ—Å—Å–∏–∏",
            "–ö–æ—Å—Ç—Ä–æ–º–∞": "–ì–æ—Ä–æ–¥ –≤ –†–æ—Å—Å–∏–∏ –Ω–∞ —Ä–µ–∫–µ –í–æ–ª–≥–µ",
            "–†—ã–±–∏–Ω—Å–∫": "–í—Ç–æ—Ä–æ–π –ø–æ –≤–µ–ª–∏—á–∏–Ω–µ –≥–æ—Ä–æ–¥ –≤ –Ø—Ä–æ—Å–ª–∞–≤—Å–∫–æ–π –æ–±–ª–∞—Å—Ç–∏ –†–æ—Å—Å–∏–∏",
            "–ú—É—Ä–æ–º": "–ì–æ—Ä–æ–¥ –≤ –†–æ—Å—Å–∏–∏",
            "–°–µ—Ä–≥–∏–µ–≤ –ü–æ—Å–∞–¥": "–ì–æ—Ä–æ–¥ –≤ –ú–æ—Å–∫–æ–≤—Å–∫–æ–π –æ–±–ª–∞—Å—Ç–∏ –†–æ—Å—Å–∏–∏",
            "–î–º–∏—Ç—Ä–æ–≤": "–ì–æ—Ä–æ–¥ –≤ –†–æ—Å—Å–∏–∏",
            "–ê–ª–µ–∫—Å–∞–Ω–¥—Ä–æ–≤": "–ì–æ—Ä–æ–¥ –≤ –†–æ—Å—Å–∏–∏",
            "–®—É—è": "–ì–æ—Ä–æ–¥ –≤ –ò–≤–∞–Ω–æ–≤—Å–∫–æ–π –æ–±–ª–∞—Å—Ç–∏ –†–æ—Å—Å–∏–∏",
            "–ì—É—Å—å-–•—Ä—É—Å—Ç–∞–ª—å–Ω—ã–π": "–ì–æ—Ä–æ–¥ –≤ –†–æ—Å—Å–∏–∏",
            "–¢—É—Ç–∞–µ–≤": "–ì–æ—Ä–æ–¥ –æ–±–ª–∞—Å—Ç–Ω–æ–≥–æ –ø–æ–¥—á–∏–Ω–µ–Ω–∏—è –≤ –†–æ—Å—Å–∏–∏",
            "–ü–µ—Ä–µ—Å–ª–∞–≤–ª—å-–ó–∞–ª–µ—Å—Å–∫–∏–π": "–ì–æ—Ä–æ–¥ –≤ –Ø—Ä–æ—Å–ª–∞–≤—Å–∫–æ–π –æ–±–ª–∞—Å—Ç–∏ –†–æ—Å—Å–∏–∏",
            "–£–≥–ª–∏—á": "–ì–æ—Ä–æ–¥ –≤ –†–æ—Å—Å–∏–∏",
            "–ö–∞—Å–∏–º–æ–≤": "–ì–æ—Ä–æ–¥ –≤ –†–æ—Å—Å–∏–∏",
            "–†–æ—Å—Ç–æ–≤ –í–µ–ª–∏–∫–∏–π": "–ì–æ—Ä–æ–¥ –≤ –†–æ—Å—Å–∏–∏",
            "–Æ—Ä—å–µ–≤-–ü–æ–ª—å—Å–∫–∏–π": "–ì–æ—Ä–æ–¥ –≤ –†–æ—Å—Å–∏–∏",
            "–ì–æ—Ä–æ—Ö–æ–≤–µ—Ü": "–ì–æ—Ä–æ–¥ —Ä–∞–π–æ–Ω–Ω–æ–≥–æ –ø–æ–¥—á–∏–Ω–µ–Ω–∏—è –≤ –†–æ—Å—Å–∏–∏",
            "–ö–∞–ª—è–∑–∏–Ω": "–ì–æ—Ä–æ–¥ –≤ –¢–≤–µ—Ä—Å–∫–æ–π –æ–±–ª–∞—Å—Ç–∏ –†–æ—Å—Å–∏–∏",
            "–°—É–∑–¥–∞–ª—å": "–ì–æ—Ä–æ–¥-–∑–∞–ø–æ–≤–µ–¥–Ω–∏–∫ –≤–æ –í–ª–∞–¥–∏–º–∏—Ä—Å–∫–æ–π –æ–±–ª–∞—Å—Ç–∏ –†–æ—Å—Å–∏–∏",
            "–ú—ã—à–∫–∏–Ω": "–ì–æ—Ä–æ–¥ –≤ –†–æ—Å—Å–∏–∏",
            "–ë–æ–≥–æ–ª—é–±–æ–≤–æ": "–ü–æ—Å—ë–ª–æ–∫ –≤ –°—É–∑–¥–∞–ª—å—Å–∫–æ–º —Ä–∞–π–æ–Ω–µ –í–ª–∞–¥–∏–º–∏—Ä—Å–∫–æ–π –æ–±–ª–∞—Å—Ç–∏ –†–æ—Å—Å–∏–∏",
            "–ü–∞–ª–µ—Ö": "–ü–æ—Å—ë–ª–æ–∫ –≥–æ—Ä–æ–¥—Å–∫–æ–≥–æ —Ç–∏–ø–∞ –ü–∞–ª–µ—Ö—Å–∫–æ–≥–æ —Ä–∞–π–æ–Ω–∞ –ò–≤–∞–Ω–æ–≤—Å–∫–æ–π –æ–±–ª–∞—Å—Ç–∏ –†–æ—Å—Å–∏–π—Å–∫–æ–π –§–µ–¥–µ—Ä–∞—Ü–∏–∏",
            "–ü–ª—ë—Å": "–ì–æ—Ä–æ–¥ –Ω–∞ –í–æ–ª–≥–µ",
            "–ö–∏–¥–µ–∫—à–∞": "–°–µ–ª–æ –≤ –°—É–∑–¥–∞–ª—å—Å–∫–æ–º —Ä–∞–π–æ–Ω–µ –í–ª–∞–¥–∏–º–∏—Ä—Å–∫–æ–π –æ–±–ª–∞—Å—Ç–∏ –†–æ—Å—Å–∏–∏"
        };

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        function initPage() {
            // –ó–∞–ø–æ–ª–Ω—è–µ–º —Å–µ—Ç–∫—É –≥–æ—Ä–æ–¥–æ–≤
            const citiesGrid = document.getElementById('cities-grid');
            for (const [city, description] of Object.entries(cities)) {
                const cityCard = document.createElement('div');
                cityCard.className = 'city-card';
                cityCard.innerHTML = `
                    <div class="city-name">${city}</div>
                    <div class="city-description">${description}</div>
                `;
                cityCard.onclick = () => showPlaces(city);
                citiesGrid.appendChild(cityCard);
            }

            // –ó–∞–ø–æ–ª–Ω—è–µ–º –≤—ã–ø–∞–¥–∞—é—â–∏–π —Å–ø–∏—Å–æ–∫ –≥–æ—Ä–æ–¥–æ–≤ –≤ —Ñ–æ—Ä–º–µ
            const citySelect = document.getElementById('city');
            for (const city of Object.keys(cities)) {
                const option = document.createElement('option');
                option.value = city;
                option.textContent = city;
                citySelect.appendChild(option);
            }
        }

        // –ü–æ–∫–∞–∑–∞—Ç—å —Å–ø–∏—Å–æ–∫ –≥–æ—Ä–æ–¥–æ–≤
        function showCities() {
            document.getElementById('cities-container').style.display = 'block';
            document.getElementById('places-container').style.display = 'none';
        }

        // –ü–æ–∫–∞–∑–∞—Ç—å –¥–æ—Å—Ç–æ–ø—Ä–∏–º–µ—á–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –≥–æ—Ä–æ–¥–∞
        async function showPlaces(city) {
            document.getElementById('cities-container').style.display = 'none';
            document.getElementById('places-container').style.display = 'block';
            
            document.getElementById('city-title').textContent = city;
            document.getElementById('city-description').textContent = cities[city];

            try {
                const response = await fetch(`http://localhost:8000/places/?city=${encodeURIComponent(city)}`);
                const places = await response.json();

                const placesList = document.getElementById('places-list');
                placesList.innerHTML = '';

                if (places.length === 0) {
                    placesList.innerHTML = '<p>–í —ç—Ç–æ–º –≥–æ—Ä–æ–¥–µ –ø–æ–∫–∞ –Ω–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã—Ö –¥–æ—Å—Ç–æ–ø—Ä–∏–º–µ—á–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π.</p>';
                } else {
                    for (const place of places) {
                        const placeCard = document.createElement('div');
                        placeCard.className = 'place-card';
                        placeCard.innerHTML = `
                            <div class="place-name">${place.name}</div>
                            <div class="place-info">üìç ${place.address}</div>
                            <div class="place-info">üìù ${place.description}</div>
                            <div class="place-info">üè∑ ${place.category}</div>
                            <div class="place-info">‚≠ê –†–µ–π—Ç–∏–Ω–≥: <span class="rating">${place.rating.toFixed(1)}</span></div>
                            <div class="rating-buttons">
                                ${[1,2,3,4,5].map(rating => `
                                    <button class="rating-button" onclick="ratePlace(${place.id}, ${rating})">
                                        ${'‚≠ê'.repeat(rating)}
                                    </button>
                                `).join('')}
                            </div>
                            <div class="comments">
                                <h4>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏:</h4>
                                ${place.comments ? place.comments.map(comment => `
                                    <div class="comment">${comment.text}</div>
                                `).join('') : '<p>–ü–æ–∫–∞ –Ω–µ—Ç –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤</p>'}
                                <div class="comment-form">
                                    <input type="text" class="comment-input" placeholder="–î–æ–±–∞–≤–∏—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π" 
                                           onkeypress="if(event.key === 'Enter') addComment(${place.id}, this.value)">
                                </div>
                            </div>
                        `;
                        placesList.appendChild(placeCard);
                    }
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –¥–æ—Å—Ç–æ–ø—Ä–∏–º–µ—á–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π:', error);
            }
        }

        // –û—Ü–µ–Ω–∫–∞ –º–µ—Å—Ç–∞
        async function ratePlace(placeId, rating) {
            try {
                const response = await fetch(`http://localhost:8000/places/${placeId}/rate`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${tg.initData}`
                    },
                    body: JSON.stringify({ rating })
                });

                if (response.ok) {
                    // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –º–µ—Å—Ç–∞
                    const cityTitle = document.getElementById('city-title').textContent;
                    showPlaces(cityTitle);
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ü–µ–Ω–∫–µ –º–µ—Å—Ç–∞:', error);
            }
        }

        // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è
        async function addComment(placeId, text) {
            if (!text.trim()) return;

            try {
                const response = await fetch(`http://localhost:8000/places/${placeId}/comment`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${tg.initData}`
                    },
                    body: JSON.stringify({ text })
                });

                if (response.ok) {
                    // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –º–µ—Å—Ç–∞
                    const cityTitle = document.getElementById('city-title').textContent;
                    showPlaces(cityTitle);
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è:', error);
            }
        }

        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Ñ–æ—Ä–º—ã
        document.getElementById('placeForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const formData = new FormData();
            formData.append('name', document.getElementById('name').value);
            formData.append('description', document.getElementById('description').value);
            formData.append('city', document.getElementById('city').value);
            formData.append('address', document.getElementById('address').value);
            formData.append('category', document.getElementById('category').value);
            
            const imageFile = document.getElementById('image').files[0];
            if (imageFile) {
                formData.append('file', imageFile);
            }

            try {
                const response = await fetch('http://localhost:8000/places/', {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${tg.initData}`
                    },
                    body: formData
                });

                if (response.ok) {
                    showMessage('–î–æ—Å—Ç–æ–ø—Ä–∏–º–µ—á–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å —É—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–∞!', 'success');
                    this.reset();
                    // –û–±–Ω–æ–≤–ª—è–µ–º —Å–ø–∏—Å–æ–∫ –¥–æ—Å—Ç–æ–ø—Ä–∏–º–µ—á–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π, –µ—Å–ª–∏ –º—ã –Ω–∞—Ö–æ–¥–∏–º—Å—è –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ –≥–æ—Ä–æ–¥–∞
                    const cityTitle = document.getElementById('city-title').textContent;
                    if (cityTitle) {
                        showPlaces(cityTitle);
                    }
                } else {
                    const error = await response.json();
                    showMessage('–û—à–∏–±–∫–∞: ' + error.detail, 'error');
                }
            } catch (error) {
                showMessage('–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ –¥–∞–Ω–Ω—ã—Ö: ' + error.message, 'error');
            }
        });

        function showMessage(text, type) {
            const messageDiv = document.getElementById('message');
            messageDiv.textContent = text;
            messageDiv.className = 'message ' + type;
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        document.addEventListener('DOMContentLoaded', initPage);
    </script>
</body>
</html> 
